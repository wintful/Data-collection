<!DOCTYPE html>
<html lang="en" style="height: 100%">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="text/javascript" src="resources/jquery-3.1.1.min.js"></script>
    <script type="text/javascript" src="resources/echarts.common.min.js"></script>
</head>
<body style="height: 100%; margin: 0">
<!--<div id="ajtxt" style="width: 100%;height: 100%;"></div>-->
<div id="container" style="height: 100%"></div>
<script>

    var arr = "[{'bookName':'稀见民国佛教文献汇编（报纸）（8开精装 全13册)','bookPrice':9560.00},{'bookName':'普慧大藏经全套42卷 豪华精装 佛教界编修的一部大藏经 汉文佛教典籍 中国书店','bookPrice':9458.00},{'bookName':'齐白石全集(套装全10卷) 齐白石；郎绍君,郭天民 9787535608956 湖南美术出版社','bookPrice':8624.00},{'bookName':'安全生产公益广告三则 2015年安全月 童画篇 讲述篇 别缺席孩子的人生','bookPrice':8082.00},{'bookName':'齐白石全集（全十卷）','bookPrice':7742.00},{'bookName':'海派绘画大系（全24册）','bookPrice':7742.00},{'bookName':'中国军事百科全书（第二版）','bookPrice':7584.00},{'bookName':'琴曲集成(全30册)精','bookPrice':7546.00},{'bookName':'资治通鉴（繁体竖排点校本、线装、全八十册）','bookPrice':7326.00},{'bookName':'《普通法图书馆》全10册','bookPrice':6735.00},{'bookName':'中华文化通志（全套101卷）/《中华文化通志》编委会/上海人民出版社/','bookPrice':6400.00},{'bookName':'论语(套装共15册) 论语社 9787545807042 上海书店出版社','bookPrice':6349.00},{'bookName':'2015年安全月主题片 关注安全关爱生命 安全生产公益广告三则3DVD 9787798641035','bookPrice':6286.00},{'bookName':'机械工程名词:五:物料搬运机械 流体机械 工程机械 动力机械','bookPrice':6084.00},{'bookName':'二十四史（繁体竖排点校精装版，全241册共6箱）','bookPrice':5688.00},{'bookName':'中国美术全集','bookPrice':5522.10},{'bookName':'本草纲目 金陵本','bookPrice':5520.00},{'bookName':'戴敦邦画谱全集（珍藏本）','bookPrice':5514.20},{'bookName':'拓跋廛丛刻-(一函八册)( 货号:780663451689)','bookPrice':5440.00},{'bookName':'中国近代经济史参考资料丛刊','bookPrice':5372.00}] ";


    $.get("DataAnalysis?op=pricedesc", function (data, status) {

        if (status === 'success') {

            alert("Data: " + data + "\nStatus: " + status);

            arr = data;

//            var obj = eval('(' + arr + ')');
        } else {
            alert("加载出错！");
        }
    });


    var jsondata = eval("(" + arr + ")");
    //alert(obj[0].bookName + " + " + obj[0].bookPrice);


    var bookNames = [];
    var bookPrices = [];
    $.each(jsondata, function (idx, obj) {
        var bookName = obj.bookName.split(/\（|\(| |-|:|：/);

        bookNames[idx] = bookName[0];
        bookPrices[idx] = obj.bookPrice;
    });
    // alert(bookNames);
    // alert(bookPrices);

    // ----------------------------------

    var dom = document.getElementById("container");

    var myChart = echarts.init(dom);

    option = null;

    // var dataAxis = ['点-字符测试', '击', '柱', '子', '或', '者', '两', '指', '在', '触', '屏', '上', '滑', '动', '能', '够', '自', '动', '缩', '放'];
    var dataAxis = bookNames;

    //var data = [220, 182, 191, 234, 290, 330, 310, 123, 442, 321, 90, 149, 210, 122, 133, 334, 198, 123, 125, 220];

    var data = bookPrices;

    var yMax = 500;
    var dataShadow = [];

    for (var i = 0; i < data.length; i++) {
        dataShadow.push(yMax);
    }

    option = {
        title: {
            text: '当当网图书价格 降序排序',
            subtext: ''
        },
        xAxis: {

            data: dataAxis,
            axisLabel: {
                inside: true,
                textStyle: {
                    color: '#fff'
                }
            },
            axisTick: {
                show: false
            },
            axisLine: {
                show: false
            },
            z: 10
        },
        yAxis: {
            axisLine: {
                show: false
            },
            axisTick: {
                show: false
            },
            axisLabel: {
                textStyle: {
                    color: '#999'
                }
            }
        },
        dataZoom: [
            {
                type: 'inside'
            }
        ],
        series: [
            { // For shadow
                type: 'bar',
                itemStyle: {
                    normal: {color: 'rgba(0,0,0,0.05)'}
                },
                barGap: '-100%',
                barCategoryGap: '40%',
                data: dataShadow,
                animation: false
            },
            {
                type: 'bar',
                itemStyle: {
                    normal: {
                        color: new echarts.graphic.LinearGradient(
                            0, 0, 0, 1,
                            [
                                {offset: 0, color: '#83bff6'},
                                {offset: 0.5, color: '#188df0'},
                                {offset: 1, color: '#188df0'}
                            ]
                        )
                    },
                    emphasis: {
                        color: new echarts.graphic.LinearGradient(
                            0, 0, 0, 1,
                            [
                                {offset: 0, color: '#2378f7'},
                                {offset: 0.7, color: '#2378f7'},
                                {offset: 1, color: '#83bff6'}
                            ]
                        )
                    }
                },
                data: data
            }
        ]

    };

    // Enable data zoom when user click bar.
    var zoomSize = 6;
    myChart.on('click', function (params) {
        console.log(dataAxis[Math.max(params.dataIndex - zoomSize / 2, 0)]);
        myChart.dispatchAction({
            type: 'dataZoom',
            startValue: dataAxis[Math.max(params.dataIndex - zoomSize / 2, 0)],
            endValue: dataAxis[Math.min(params.dataIndex + zoomSize / 2, data.length - 1)]
        });
    });
    /*
     myChart.on('mouseover',function (params) {
     alert(dataAxis[Math.max(params.dataIndex - zoomSize / 2, 0)]);
     });
     */
    if (option && typeof option === "object") {
        myChart.setOption(option, true);
    }
    /*    }else{
     alert("加载出错！");
     }
     });*/
</script>
</body>
</html>